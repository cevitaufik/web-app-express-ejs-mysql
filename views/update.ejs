<% 
  const clearDesc = (desc) => {
    return desc.replace(/"/g, '').replace('[', '').replace(']', '');
  }

  const image = JSON.parse(product.image);
  const desc = JSON.parse(product.description);

%>

<div class="grid justify-items-center py-10">
  <div class="w-3/4 md:w-3/5 bg-purple-300 shadow-md rounded-lg pt-8">
    <p class="text-center text-2xl font-bold">Perbaharui produk</p>
    <% if (locals.isLoggedIn) { %>
    <form class="w-3/4 mx-auto pt-6 pb-8 mb-4" action="/update" method="POST">
      <input type="hidden" id="id" name="id" value="<%= product.id %>">
      <div class="flex flex-row justify-center">
        <% for( let i = 0; i < image.length; i++ ) { %>
        <img src="/<%= image[i] %>" alt="<%= product.name %>" class="mb-4 block w-1/3 mx-1">
        <% } %>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="name">
          Nama barang
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="name" type="text" placeholder="Nama barang" name="name" value="<%= product.name %>" required>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="price">
          Harga
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="price" type="text" placeholder="Harga" name="price" value="<%= product.price %>" required>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="category">
          Kategori
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="category" type="text" placeholder="Kategori" name="category" value="<%= product.category %>" required>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="description">
          Deskripsi
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="description" type="text" placeholder="Deskripsi (pisahkan dengan koma)" name="description" value="<%= desc.toString() %>" required>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="bestProduct">
          Unggulan
        </label>
        <input type="radio" value="Y" name="bestProduct">
        <label for="Y" class="mr-5">Ya</label>
        <input type="radio" value="N" name="bestProduct" checked>
        <label for="N">Tidak</label>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="shopee">
          Shopee
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="shopee" type="text" placeholder="Link Shopee" value="<%= product.shopee %>" name="shopee">
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="tokopedia">
          Tokopedia
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="tokopedia" type="text" placeholder="Link Tokopedia" name="tokopedia" value="<%= product.tokopedia %>">
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="foto1">
          Foto cover
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="foto1" type="file" name="foto1">
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="foto2">
          Foto ke 2
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="foto2" type="file" name="foto2">
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-bold mb-2" for="foto3">
          Foto ke 3
        </label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="foto3" type="file" name="foto3">
      </div>


      <div class="flex justify-end">
        <button class="bg-ungu block hover-text-ungu text-white font-bold py-2 px-4 rounded-full focus:outline-none focus:shadow-outline" type="submit">
          Simpan
        </button>
      </div>
    </form>
    <% } else { %>
    <h1 class="text-center text-2xl font-bold my-10">Silahkan login terlebih dahulu</h1>
    <% } %>
  </div>
</div>

<% if (locals.isLoggedIn) { %>
<div class="float-right fixed bottom-5 right-5">
  <a href="/logout" class="bg-pink-500 text-white hover:bg-white hover:text-pink-500 font-bold py-2 px-3 rounded-full">Logout</a>
</div>
<% } %>